# 67 Hub

Artist management portal for 67 Label. A PWA for managing social media content with approval workflows.

**Status**: ğŸš§ MVP Ready - Core features implemented, E2E test compliance in progress

## Features

### âœ… Implemented

- **Authentication**: Login with role-based access (Admin, Manager, Artist)
- **Posts Management**: Create, edit, schedule posts across multiple platforms
- **Approval Workflow**: Staff creates â†’ Artist approves/rejects â†’ Publish
- **Post History & Comments**: Full audit trail and collaboration
- **Calendar View**: Visual overview of scheduled content with filters
- **Real-time Chat**: Communication between staff and artists
- **Notifications**: Updates on post status changes
- **Dashboard**: Role-specific views with stats and quick actions
- **Artists Management**: View artists roster with stats
- **Content Locking**: Posts locked during review/approval phases
- **Mobile-first**: Responsive design with mobile navigation

### ğŸš§ In Progress

- **Chat Optimistic Updates**: Show sent messages immediately
- **Calendar Artist Colors**: Different colors for each artist's posts
- **Error Handling**: Better error messages and loading states

### ğŸ“‹ Planned (E2E Test Compliance)

- **Media Upload**:
  - Drag & drop interface
  - Image/video preview
  - File validation (size, type)
  - Multiple media per post
  - Reorder functionality

- **Artists CRUD**:
  - Create artist form with credentials
  - Edit artist profile
  - Delete artist with confirmation
  - Password reset for artists
  - Color picker for branding

- **Advanced Calendar**:
  - Week view
  - Click day to create post
  - Event tooltips with details

- **Dashboard Enhancements**:
  - Today's scheduled posts
  - Mini calendar widget
  - Recent activity feed

- **Notifications Dropdown**: Quick access from navbar

## Tech Stack

- **Frontend**: React 18 + Vite
- **Styling**: Tailwind CSS
- **Backend**: Supabase (PostgreSQL, Auth, Realtime, Storage)
- **State Management**: Zustand
- **Routing**: React Router 6
- **Date Handling**: date-fns
- **Icons**: Lucide React
- **Testing**: Playwright (E2E)

## Project Structure

```
67-HUB/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/           # Page components
â”‚   â”‚   â”œâ”€â”€ Login.jsx
â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx
â”‚   â”‚   â”œâ”€â”€ Posts.jsx
â”‚   â”‚   â”œâ”€â”€ PostDetail.jsx
â”‚   â”‚   â”œâ”€â”€ PostEditor.jsx
â”‚   â”‚   â”œâ”€â”€ Calendar.jsx
â”‚   â”‚   â”œâ”€â”€ Chat.jsx
â”‚   â”‚   â”œâ”€â”€ Artists.jsx
â”‚   â”‚   â””â”€â”€ Notifications.jsx
â”‚   â”œâ”€â”€ components/      # Shared components
â”‚   â”‚   â””â”€â”€ Layout.jsx
â”‚   â”œâ”€â”€ stores/          # Zustand stores
â”‚   â”‚   â”œâ”€â”€ authStore.js
â”‚   â”‚   â””â”€â”€ notificationStore.js
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â””â”€â”€ supabase.js  # Supabase client
â”‚   â””â”€â”€ App.jsx
â”œâ”€â”€ supabase/
â”‚   â””â”€â”€ migrations/      # SQL migrations
â”‚       â”œâ”€â”€ 001_initial_schema.sql
â”‚       â””â”€â”€ 002_rls_policies.sql
â”œâ”€â”€ testE2E/             # Playwright E2E tests
â””â”€â”€ vercel.json          # Vercel SPA config
```

## Setup

### 1. Prerequisites

- Node.js 18+
- Supabase account
- Vercel account (for deployment)

### 2. Clone & Install

```bash
git clone https://github.com/raydalessandro/67-HUB.git
cd 67-HUB
npm install
```

### 3. Environment Setup

Copy `.env.example` to `.env` and add your Supabase credentials:

```env
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
```

### 4. Database Setup

#### Step 1: Run Migrations

In Supabase SQL Editor, execute in order:

1. `supabase/migrations/001_initial_schema.sql`
2. `supabase/migrations/002_rls_policies.sql`

#### Step 2: Create Auth Users

In Supabase Dashboard â†’ Authentication â†’ Users, create:

| Role | Email | Password | Auto Confirm |
|------|-------|----------|--------------|
| Admin | admin@67hub.test | Admin123! | âœ… Yes |
| Manager | manager@67hub.test | Manager123! | âœ… Yes |
| Artist 1 | artist1@67hub.test | Artist123! | âœ… Yes |
| Artist 2 | artist2@67hub.test | Artist123! | âœ… Yes |

**Copy the UUIDs** generated by Supabase for each user.

#### Step 3: Create User Profiles & Artists

In SQL Editor, replace UUIDs with the ones from Step 2:

```sql
-- Insert user profiles
INSERT INTO users (id, email, display_name, role)
VALUES
  ('UUID_ADMIN', 'admin@67hub.test', 'Admin User', 'admin'),
  ('UUID_MANAGER', 'manager@67hub.test', 'Manager User', 'manager'),
  ('UUID_ARTIST1', 'artist1@67hub.test', 'MC Test', 'artist'),
  ('UUID_ARTIST2', 'artist2@67hub.test', 'DJ Sample', 'artist');

-- Insert artists
INSERT INTO artists (user_id, name, color, bio)
VALUES
  ('UUID_ARTIST1', 'MC Test', '#FF5500', 'Test rapper'),
  ('UUID_ARTIST2', 'DJ Sample', '#00AAFF', 'Test DJ');
```

#### Step 4: Enable Realtime

In Supabase Dashboard â†’ Database â†’ Replication:

Enable realtime for these tables:
- âœ… `posts`
- âœ… `chat_messages`
- âœ… `notifications`

### 5. Run Development Server

```bash
npm run dev
```

Open [http://localhost:5173](http://localhost:5173)

### 6. Build for Production

```bash
npm run build
```

## Deployment

### Vercel

1. Connect GitHub repository to Vercel
2. Set environment variables in Vercel dashboard
3. Deploy

**Important**: The `vercel.json` file is required for SPA routing to work correctly.

## User Roles & Permissions

### Admin
- âœ… Full access to all features
- âœ… Create posts for any artist
- âœ… Approve/reject posts
- âœ… Manage artists
- âœ… View all conversations

### Manager
- âœ… Create posts for any artist
- âœ… View all posts and calendar
- âœ… View all conversations
- âŒ Cannot manage artists

### Artist
- âœ… View posts assigned to them
- âœ… Approve/reject posts created by staff
- âœ… Comment on their posts
- âœ… Chat with staff
- âŒ Cannot create posts
- âŒ Cannot access other artists' content

## Workflow

1. **Staff creates post** â†’ Status: `draft`
2. **Staff sends to review** â†’ Status: `in_review`
3. **Artist reviews**:
   - Approve â†’ Status: `approved`
   - Reject (with reason) â†’ Status: `rejected`
4. **Staff marks published** (after actual posting) â†’ Status: `published`

If rejected, staff can edit and re-submit for review.

## API Structure

All data queries use Supabase PostgREST API with RLS policies:

- **Posts**: Role-based filtering (staff see all, artists see only theirs)
- **Comments**: Accessible to users who can view the post
- **History**: Audit trail for all post changes
- **Chat**: Private conversations between staff and specific artists
- **Notifications**: User-specific

## Database Schema

Key tables:
- `users` - User profiles (extends auth.users)
- `artists` - Artist profiles with branding
- `posts` - Social media posts
- `post_media` - Media files attached to posts
- `post_comments` - Collaboration comments
- `post_history` - Audit trail
- `conversations` - Chat rooms (one per artist)
- `chat_messages` - Chat messages
- `notifications` - User notifications

See `supabase/migrations/001_initial_schema.sql` for full schema.

## E2E Tests

Playwright tests located in `testE2E/67-hub-e2e-tests/`:

```bash
# Run E2E tests
cd testE2E/67-hub-e2e-tests
npm install
npx playwright test
```

All components have `data-testid` attributes for E2E testing.

## Known Issues

- [ ] Chat messages require page refresh to see own sent messages (optimistic update needed)
- [ ] Calendar doesn't show artist-specific colors yet
- [ ] Media upload UI not yet implemented
- [ ] Some error states need better UX

## Contributing

This is a private project for 67 Label. For questions or issues, contact the development team.

## License

Private - 67 Label Â© 2026
